## generator (генератор)

Генераторы - это специальный класс функций, который позволяет легко создавать свои итераторы.
В отличии от обычных функций, генератор не просто возвращает значение и завершает работу, а возвращает итератор, который отдает элементы по одному.


Обычная функция завершает работу если:
* встретилось выражение return
* закончился код функции (это срабатывает как выражение ```return None```)
* возникло исключение

После выполнения функции, управление возвращается и программа выполняется дальше.
Все аргументы, которые передавались в функцию, локальные переменные, все это теряется.
Остается только результат, который вернула функция.

Функция может возвращать список элементов, несколько объектов или возвращать разные результаты, в зависимости от аргументов, но она всегда возвращает какой-то один результат.

Генератор же генерирует значения.
При этом, значения возвращаются по запросу и после возврата одного значения, выполнение функции-генератора приостанавливается до запроса следующего значения.
Между запросами генератор сохраняет свое состояние.


С точки зрения синтаксиса, генератор выглядит как обычная функция.
Но, вместо return, используется оператор ```yield```.

Каждый раз, когда внутри функции встречается yield, генератор приостанавливается и возвращает значение.
При следующем запросе, генератор начинает работать с того же места, где он завершил работу в прошлый раз.

Так как yield не завершает работу генератора, он может использоваться несколько раз.

Рассмотрим простой пример генератора:
```python
In [1]: def generate_nums(number):
   ...:     print('Start of generation')
   ...:     yield number
   ...:     print('Next number')
   ...:     yield number+1
   ...:     print('The end')
   ...:

```

Если вызвать генератор и присвоить результат в переменную, его код еще не будет выполняться:
```python
In [3]: result = generate_nums(100)
```

Теперь в переменной result находится итератор:
```python
In [4]: result
Out[4]: <generator object generate_nums at 0xb5788e9c>
```

Раз result это итератор, можно вызвать функцию next, чтобы получить значение:
```python
In [5]: next(result)
Start of generation
Out[5]: 100

```

После первого вызова next, генератор выполнил все строки до первого yield.
В данном случае, отобразилась строка 'Start of generation'.
Затем yield вернул значение - число 100.

Второй вызов next:
```python
In [6]: next(result)
Next number
Out[6]: 101
```

Выполнение продолжилось с предыдущего места - выведена строка 'Next number' и вернулось значение 101.

Следующий next:
```python
In [7]: next(result)
The end
------------------------------------------------------------
StopIteration              Traceback (most recent call last)
<ipython-input-7-1b214ba10814> in <module>()
----> 1 next(result)

StopIteration:

```

Так как в result находится итератор, когда элементы заканчиваются, он генерирует исключение StopIteration.
Но, до этого, вывелась строка 'The end'.

Раз функция-генератор возвращает итератор, его можно использовать в цикле:
```python
In [8]: for num in generate_nums(100):
   ...:     print('Number:', num)
   ...:
Start of generation
Number: 100
Next number
Number: 101
The end

```


